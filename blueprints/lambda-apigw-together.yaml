spec_version: 1
kind: blueprint
metadata:
  description: Lambda example using API GW and DynamoDB

clouds: 
  - AWSOther: us-east-1

inputs:
  - REGION: us-east-1
  - base_domain:
      description: Domain name in your Route 53 hosted zones, must be public
  - lambda_role_arn: 
      description: Role arn used by Lambda. Must include ability to create and write to CloudWatch Log groups and put items in dynamoDB.

applications:
  - lambda-app:

services:
  - lambda-hello-world:
        input_values:
          - branch: $colony.repos.current.branch
          - sandbox_id: $colony.environment.id
          - REGION: $REGION
          - lambda_role_arn: $lambda_role_arn
          - base_domain: $base_domain

ingress:
  listeners:
    - http: 80
      rules:
      - default: true
        port: 80
        application: lambda-app
        shortcut: ${colony.environment.id}.${base_domain}/${colony.environment.id}


debugging:
  availability: on
